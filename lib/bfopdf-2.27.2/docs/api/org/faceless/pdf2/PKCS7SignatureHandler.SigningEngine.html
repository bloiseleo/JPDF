<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>PKCS7SignatureHandler.SigningEngine (Big Faceless PDF Library 2.27.2)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
<script type="text/javascript" src="../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../jquery/jquery-3.5.1.js"></script>
<script type="text/javascript" src="../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="PKCS7SignatureHandler.SigningEngine (Big Faceless PDF Library 2.27.2)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../";
var useModuleDirectories = false;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PKCS7SignatureHandler.SigningEngine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Big Faceless PDF Library 2.27.2</div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">org.faceless.pdf2</a></div>
<h2 title="Interface PKCS7SignatureHandler.SigningEngine" class="title">Interface PKCS7SignatureHandler.SigningEngine</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Enclosing class:</dt>
<dd><a href="PKCS7SignatureHandler.html" title="class in org.faceless.pdf2">PKCS7SignatureHandler</a></dd>
</dl>
<hr>
<pre>public static interface <span class="typeNameLabel">PKCS7SignatureHandler.SigningEngine</span></pre>
<div class="block">This interface defines the engine used to actually sign a PDF.
 The <a href="AcrobatSignatureHandlerFactory.html#createSigningEngine(java.security.KeyStore,java.lang.String,char%5B%5D,java.lang.String)"><code>AcrobatSignatureHandlerFactory.createSigningEngine(java.security.KeyStore, java.lang.String, char[], java.lang.String)</code></a> method
 will return an instance of this interface to do the signing. If a
 custom method of signing is required, for example on a remote server,
 this is the interface that will need implementing</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.22</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static class&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="PKCS7SignatureHandler.SigningEngine.Type.html" title="enum in org.faceless.pdf2">PKCS7SignatureHandler.SigningEngine.Type</a></span></code></th>
<td class="colLast">&nbsp;</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/cert/X509Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">X509Certificate</a>&gt;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getCertificates()">getCertificates</a></span>()</code></th>
<td class="colLast">
<div class="block">
 Return the full list of X.509 certificates to be embedded into the
 signature.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getDigestEncryptionAlgorithm()">getDigestEncryptionAlgorithm</a></span>()</code></th>
<td class="colLast">
<div class="block">Return the Digest Encryption algorithm of the signature returned from <a href="#sign(byte%5B%5D)"><code>sign(byte[])</code></a>,
 eg "SHA1withRSA", "SHA1withDSA", "SHA256withECDSA", or an ASN.1 OID representing the
 same, eg "1.2.840.113549.1.1.5".</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/MessageDigest.html?is-external=true" title="class or interface in java.security" class="externalLink">MessageDigest</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getMessageDigest()">getMessageDigest</a></span>()</code></th>
<td class="colLast">
<div class="block">Return a new MessageDigest to be used to compute the signature.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getTimeStampResp(byte%5B%5D)">getTimeStampResp</a></span>&#8203;(byte[]&nbsp;digest)</code></th>
<td class="colLast">
<div class="block">
 Return an ASN.1 encoded  "TimeStampResp" (as defined in RFC3161) to be embedded in the PKCS#7 object,
 or <code>null</code> if no TimeStampResp is available.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="PKCS7SignatureHandler.SigningEngine.Type.html" title="enum in org.faceless.pdf2">PKCS7SignatureHandler.SigningEngine.Type</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getType()">getType</a></span>()</code></th>
<td class="colLast">
<div class="block">Return the type of object returned from the <a href="#sign(byte%5B%5D)"><code>sign(byte[])</code></a> method</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setPassword(javax.security.auth.callback.PasswordCallback)">setPassword</a></span>&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/javax/security/auth/callback/PasswordCallback.html?is-external=true" title="class or interface in javax.security.auth.callback" class="externalLink">PasswordCallback</a>&nbsp;callback)</code></th>
<td class="colLast">
<div class="block">Set the password on the suppled PasswordCallback.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>byte[]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#sign(byte%5B%5D)">sign</a></span>&#8203;(byte[]&nbsp;digest)</code></th>
<td class="colLast">
<div class="block">
 Actually sign the digest and returned the signature.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="getType()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getType</h4>
<pre class="methodSignature"><a href="PKCS7SignatureHandler.SigningEngine.Type.html" title="enum in org.faceless.pdf2">PKCS7SignatureHandler.SigningEngine.Type</a>&nbsp;getType()</pre>
<div class="block">Return the type of object returned from the <a href="#sign(byte%5B%5D)"><code>sign(byte[])</code></a> method</div>
</li>
</ul>
<a id="getMessageDigest()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMessageDigest</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/MessageDigest.html?is-external=true" title="class or interface in java.security" class="externalLink">MessageDigest</a>&nbsp;getMessageDigest()</pre>
<div class="block">Return a new MessageDigest to be used to compute the signature.</div>
</li>
</ul>
<a id="getCertificates()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCertificates</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util" class="externalLink">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/cert/X509Certificate.html?is-external=true" title="class or interface in java.security.cert" class="externalLink">X509Certificate</a>&gt;&nbsp;getCertificates()
                               throws <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a>,
                                      <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></pre>
<div class="block"><p>
 Return the full list of X.509 certificates to be embedded into the
 signature. This must include any certificates required to certify
 the signature up to the root certificate, and includes Certificates
 for any OCSP responders that would be queried as part of the
 Certificate verification process.
 <b>The signing Certificate must be item 0 in the list</b>.
 </p><p>
 The one exception to this is if <a href="#getType()"><code>getType()</code></a> returns <a href="PKCS7SignatureHandler.SigningEngine.Type.html#PKCS7_COMPLETE"><code>PKCS7SignatureHandler.SigningEngine.Type.PKCS7_COMPLETE</code></a>,
 in which case this method may return null.
 </p><p>
 This method will be called multiple times, so the object returned
 from this method should be stored locally.
 </p></div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
</dl>
</li>
</ul>
<a id="sign(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sign</h4>
<pre class="methodSignature">byte[]&nbsp;sign&#8203;(byte[]&nbsp;digest)
     throws <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a>,
            <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></pre>
<div class="block"><p>
 Actually sign the digest and returned the signature.
 </p><p>
 The exact format of the returned item will vary depending on the
 <a href="#getType()"><code>getType()</code></a>, but is typically the output of the
 <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/Signature.html?is-external=true#sign()" title="class or interface in java.security" class="externalLink"><code>Signature.sign()</code></a> method. For RSA signatures this
 equates to <code>rsa(pad(DigestInfo))</code>, which is effectively
 <code>rsa(pad(asn1sequence(asn1sequence(algorithm, NULL), digest)))</code>,
 where <code>rsa</code> is the RSA algorithm, <code>pad</code> is the PKCS#1 1.5
 padding algorithm, <code>algorithm</code> is the hash algorithm OID,
 and <code>digest</code> is an ASN.1 Octet string representing the digest
 supplied to this method.
 </p><p>
 The one exception to this is if <a href="#getType()"><code>getType()</code></a> returns <a href="PKCS7SignatureHandler.SigningEngine.Type.html#PKCS7_COMPLETE"><code>PKCS7SignatureHandler.SigningEngine.Type.PKCS7_COMPLETE</code></a>,
 in which case this method should return the entire PKCS#7 object to embed in
 the PDF.
 </p><p>
 This method may be called with a null argument for the digest, in which case the
 API is attempting to determine the size of the signed object for space allocation
 in the final PDF. If an accurate estimate can be made, the returned array should
 be of the correct length (the contents of the array do not matter in this case).
 If no estimate can be made this method should return a zero-length array.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>digest</code> - the digest to sign, or null if it's a test run to determine sie.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the signed object, as determined by the <a href="#getType()"><code>mode</code></a> of this object</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
</dl>
</li>
</ul>
<a id="getTimeStampResp(byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getTimeStampResp</h4>
<pre class="methodSignature">byte[]&nbsp;getTimeStampResp&#8203;(byte[]&nbsp;digest)
                 throws <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a>,
                        <a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></pre>
<div class="block"><p>
 Return an ASN.1 encoded  "TimeStampResp" (as defined in RFC3161) to be embedded in the PKCS#7 object,
 or <code>null</code> if no TimeStampResp is available. Like <a href="#sign(byte%5B%5D)"><code>sign(byte[])</code></a>,
 this method may be called with a null digest - if so the size of the returned
 array will be used to estimate how much space to allocate in the PDF. If this
 is not known, a zero-byte array should be returned.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>digest</code> - the digest to sign, or null if it's a dummy.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io" class="externalLink">IOException</a></code></dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/security/GeneralSecurityException.html?is-external=true" title="class or interface in java.security" class="externalLink">GeneralSecurityException</a></code></dd>
</dl>
</li>
</ul>
<a id="getDigestEncryptionAlgorithm()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDigestEncryptionAlgorithm</h4>
<pre class="methodSignature"><a href="https://docs.oracle.com/en/java/javase/11/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang" class="externalLink">String</a>&nbsp;getDigestEncryptionAlgorithm()</pre>
<div class="block">Return the Digest Encryption algorithm of the signature returned from <a href="#sign(byte%5B%5D)"><code>sign(byte[])</code></a>,
 eg "SHA1withRSA", "SHA1withDSA", "SHA256withECDSA", or an ASN.1 OID representing the
 same, eg "1.2.840.113549.1.1.5".</div>
</li>
</ul>
<a id="setPassword(javax.security.auth.callback.PasswordCallback)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>setPassword</h4>
<pre class="methodSignature">void&nbsp;setPassword&#8203;(<a href="https://docs.oracle.com/en/java/javase/11/docs/api/javax/security/auth/callback/PasswordCallback.html?is-external=true" title="class or interface in javax.security.auth.callback" class="externalLink">PasswordCallback</a>&nbsp;callback)</pre>
<div class="block">Set the password on the suppled PasswordCallback.
 This is required because some types of PKCS#11 token require a second login immediately
 before the "sign" call.
 For SigningEngines unconcerned with PKCS#11, this method can be a no-op.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>2.25</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/PKCS7SignatureHandler.SigningEngine.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-all.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">Big Faceless PDF Library 2.27.2</div>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small>Copyright &#169; 2001-2022 Big Faceless Organization</small></p>
</footer>
</body>
</html>
